<div class="home-container">

    <!-- Navigation Bar -->
    <!-- <nav class="navbar">
      <h1 class="navbar-title">Movie App</h1>
      <ul class="navbar-links">
          <li><a routerLink="/" routerLinkActive="active">Home</a></li>
          <li><a routerLink="/wishlist" routerLinkActive="active">Watchlist</a></li>
      </ul>
  </nav> -->

    <h1>Popular Movies</h1>

    <!-- Search Bar -->
    <div class="search-bar">
        <input
            type="text"
            placeholder="Search for movies..."
            [(ngModel)]="searchQuery"
            (input)="onSearch()"
            aria-label="Search for movies"
        />
    </div>

    <div *ngIf="loading" class="loading-indicator">
        Loading movies...
    </div>

    <div *ngIf="error && !loading" class="error-message">
        {{ error }}
    </div>

    <div *ngIf="!loading && !error && movies.length > 0" class="movie-grid">
        <a
            *ngFor="let movie of movies"
            class="movie-card"
            [routerLink]="['/movie', movie.id]"
        >
            <img
                [src]="movie.poster_path ? getPosterUrl(movie.poster_path) : 'assets/images/placeholder.png'"
                [alt]="movie.title ? movie.title + ' Poster' : 'Placeholder Poster'"
                class="movie-poster"
                loading="lazy"
                (error)="handleImageError($event)"
            />
            <div class="movie-info">
                <h3 class="movie-title">{{ movie.title || 'Untitled Movie' }}</h3>
                <p class="movie-release-date">Released: {{ movie.release_date | date:'yyyy' }}</p>
                <p class="movie-rating">Rating: {{ movie.vote_average || 'N/A' }}/10</p>
                <p class="movie-genres" *ngIf="movie.genres">Genres: {{ movie.genres.join(', ') }}</p>
            </div>
            <!-- Watchlist Button -->
            <button
                class="watchlist-button"
                (click)="toggleWatchlist(movie)"
                aria-label="Add to watchlist"
            >
            <span class="star-icon" [class.active]="isInWishlist(movie.id)">&#9733;</span>            </button>
        </a>
    </div>

    <div *ngIf="!loading && !error && movies.length === 0">
        <p>No movies found.</p>
    </div>

    <!-- Pagination Controls -->
    <div *ngIf="!loading && !error && totalPages > 0" class="pagination-controls">
        <button
            [disabled]="currentPage <= 1 || loading"
            (click)="previousPage()"
            aria-label="Go to previous page"
        >
            &laquo; Previous
        </button>

        <span> Page {{ currentPage }} of {{ totalPages }} </span>

        <button
            [disabled]="currentPage >= totalPages || loading"
            (click)="nextPage()"
            aria-label="Go to next page"
        >
            Next &raquo;
        </button>
    </div>

    <div *ngIf="!loading && !error && totalResults > 0" class="total-results">
        Total Results: {{ totalResults }} (Displaying up to 500 pages)
    </div>
</div>